!function(e){"use strict";var t=[],o=!1,a={init:function(){function t(){e(".elementor-tab-control-style").hasClass("elementor-active")?e(".elementor-control-type-section.e-open").each(function(){e(".elementor-control-type-tabs").each(function(){var t=e(this).find(".elementor-hidden-control").length>0,o=e(".elementor-control-type-tabs").hasClass("elementor-hidden-control");t&&!o?e(this).addClass("remove-tab-spacing"):e(this).removeClass("remove-tab-spacing")})}):e(".elementor-control-type-tabs").removeClass("remove-tab-spacing")}window.elementor.on("preview:loaded",a.onPreviewLoaded),window.elementor.channels.editor.on("font:insertion",a.onFontChange),window.elementor.on("panel:init",a.addMenuItems),e(document).on("click","#ai_image_button",function(t){t.preventDefault();const o=e(this).attr("data-aicontroltype");0===e("#crafto_ai_image_modal").length&&e.ajax({url:CraftoEditorScript.ajaxurl,type:"POST",data:{action:"get_modal_ai_image_html"},success:function(t){t.success&&0===e("#crafto_ai_image_modal").length&&(e("body").append(t.data),e(".close-icon").on("click",function(){e("#crafto_ai_image_modal").hide()}))}}),e("#crafto_ai_image_modal").show(),setTimeout(function(){e("#generate_image").off("click").on("click",function(){const t=e("#ai_prompt").val(),a=e("#image_size").val(),n=e("#image_art").val(),i=e("#image_lightning").val(),r=e("#image_mood").val(),l=e("#image_number").val(),c=e("#image_quality").val();""!==t?(e("#generate_image").toggleClass("ai-btn-loading"),e.ajax({url:CraftoEditorScript.ajaxurl,method:"POST",data:{action:"generate_ai_image",prompt:t,size:a,image_art:n,image_lightning:i,image_mood:r,image_number:l,image_quality:c},success:function(t){e("#generate_image").toggleClass("ai-btn-loading");const a=t.data;if(e("#ai_images").empty(),a.length>0){const t=e("<span>").addClass("ai-images-title").html("Generated Image"),n=a[0],i=e("<img>").attr("src",n.url).css({width:"200px"}),r=e("<span>").addClass("image-download-icon"),l=e("<div>").addClass("description crafto-ai-recreate").html("Not satisfied? <span>Generate Again.</span>");r.on("click",function(){const t=n.url;e("#crafto_ai_image_modal").hide(),e(window).trigger("image_selected",[t,o])}),e("#ai_images").append(t).append(i).append(r).append(l),e(".crafto-ai-image-modal-content").toggleClass("result")}else a.forEach(t=>{const a=e("<span>").addClass("ai-images-title").html("Generated Image"),n=e("<img>").attr("src",t.url).css({width:"200px"}),i=e("<span>").addClass("image-download-icon");i.on("click",function(){const a=t.url;e("#crafto_ai_image_modal").hide(),e(window).trigger("image_selected",[a,o])}),e("#ai_images").append(a).append(n).append(i).append(descriptionElement),e(".crafto-ai-image-modal-content").toggleClass("result")})},error:function(){alert(CraftoEditorScript.ai_image_generating_error_alert)}})):alert(CraftoEditorScript.ai_image_prompt_empty_alert)}),e(document).on("click",".crafto-ai-recreate",function(t){e(".crafto-ai-image-modal-content").toggleClass("result")})},2e3)}),e(window).on("image_selected",function(t,o,a){var n=a;e.ajax({url:CraftoEditorScript.ajaxurl,method:"POST",data:{action:"upload_ai_image",security:CraftoEditorScript.nonce,image_url:o,aicontrol:n},success:function(t){if(t.success){const a=t.data.attachment_id;var o=t.data.aicontrol;e.ajax({url:CraftoEditorScript.ajaxurl,method:"POST",data:{action:"get_attachment_url",attachment_id:a,aicontrol_widgets:o},success:function(t){if(t.success){const o=t.data.url,n=t.data.widget_name;if("undefined"!=typeof elementor&&elementor.getPanelView){const t=elementor.getPanelView();if(t){const i=t.getCurrentPageView();if(i&&i.model){const t=i.model;t.setSetting(n,{id:a,url:o}),t.trigger("change:"+n),elementor.reloadPreview(),e(".elementor-panel-footer-save").removeClass("elementor-button-disabled").prop("disabled",!1),e(".elementor-button").removeClass("elementor-disabled").prop("disabled",!1),e(".crafto-ai-image-modal-content").toggleClass("result")}}}}}})}},error:function(){alert(CraftoEditorScript.ai_image_upload_failed_alert)}})}),e(document).on("click","#ai_text_button",function(t){t.preventDefault();const o=e(this).attr("data-aicontroltype");0===e("#crafto_ai_text_modal").length&&e.ajax({url:CraftoEditorScript.ajaxurl,type:"POST",data:{action:"get_modal_ai_content_html"},success:function(t){t.success&&0===e("#crafto_ai_text_modal").length&&(e("body").append(t.data),e(".close-icon").on("click",function(){e("#crafto_ai_text_modal").hide()}))}}),e("#crafto_ai_text_modal").show(),setTimeout(function(){e("form#crafto-ai-form").on("submit",function(t){e("form#crafto-ai-form .button").toggleClass("ai-btn-loading"),e.ajax({url:CraftoEditorScript.ajaxurl,type:"POST",data:{action:"crafto_generate_openai_text",prompt:e("form#crafto-ai-form #prompt").val(),model:e("form#crafto-ai-form #model").val(),temperature:e("form#crafto-ai-form #temperature").val(),operation:"post",language:e("form#crafto-ai-form #language").val(),tone_of_voice:e("form#crafto-ai-form #tone-of-voice").val(),maximum_length:e("form#crafto-ai-form #maximum-length").val()},success:function(t){e("form#crafto-ai-form .button").toggleClass("ai-btn-loading"),!0===t.error?alert(t.message):(!function(t,o){var a=e("form#crafto-ai-form-result #content");if("insert_data"===t)a.val(o.content)}("insert_data",t.post),e(".crafto-ai-template-content").addClass("result"))}}),t.preventDefault()}),e("form#crafto-ai-form-result").off("submit").on("submit",function(t){const a=document.getElementById("content").value,n=elementor.getPanelView();if(n){const t=n.getCurrentPageView();if(t&&t.model){const n=t.model;n.setSetting(o,a),n.trigger("change:"+o),t.render(),elementor.reloadPreview(),e(".elementor-panel-footer-save").removeClass("elementor-button-disabled").prop("disabled",!1),e(".elementor-button").removeClass("elementor-disabled").prop("disabled",!1),e(".crafto-ai-text-modal").css("display","none")}}t.preventDefault()}),e(document).on("click",".crafto-ai-recreate",function(t){t.preventDefault(),e(".crafto-ai-template-content").removeClass("result")})},2e3)}),elementor.hooks.addAction("panel/open_editor/widget",function(){!function(){const e=document.querySelector(".elementor-panel");if(!e)return;new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.length>0&&t()})}).observe(e,{childList:!0,subtree:!0})}()}),elementor.hooks.addAction("panel/refresh",function(){t()}),elementor.channels.editor.on("section:activated",function(t){setTimeout(function(){e(".elementor-control-media").each(function(){if(0===e(this).find(".elementor-control-media-video").length&&0===e(this).find(".custom-media-button").length&&0===e(this).find(".crafto-ai-image-generate").length){var t=e(this).find('input[type="hidden"]').data("setting");e(this).find(".e-ai-button").before('<button id="ai_image_button" data-aicontroltype="'+t+'" class="crafto-ai-image-generate"><img src="'+CraftoEditorScript.ai_button_logo_url+'" class="attachment-full size-full" alt="ai-logo"></button>')}})},1e3),setTimeout(function(){e(".elementor-control-type-text, .elementor-control-type-textarea").each(function(){if(!e(this).find(".crafto-ai-text-generate").length){var t=e(this).find("input, textarea").data("setting");e(this).find(".e-ai-button").before('<button id="ai_text_button" data-aicontroltype="'+t+'" class="crafto-ai-text-generate"><img src="'+CraftoEditorScript.ai_button_logo_url+'" class="attachment-full size-full" alt="ai-logo"></button>')}}),e(".elementor-control-type-wysiwyg").each(function(){for(var t=e(this).attr("class").split(/\s+/),o=null,a=0;a<t.length;a++)if(t[a].startsWith("elementor-control-")&&"elementor-control-type-wysiwyg"!==t[a]){o=t[a].replace("elementor-control-","");break}o&&!e(this).find(".crafto-ai-text-generate").length&&e(this).find(".e-ai-button").before('<button id="ai_text_button" data-aicontroltype="'+o+'" class="crafto-ai-text-generate"><img src="'+CraftoEditorScript.ai_button_logo_url+'" class="attachment-full size-full" alt="ai-logo"></button>')})},1e3)}),t()},onPreviewLoaded:function(){["crafto-accordion.default","crafto-dynamic-slider.default","crafto-hamburger-menu.default","crafto-popup.default","crafto-price-table.default","crafto-stack-section.default","crafto-tabs.default"].forEach(t=>{elementorFrontend.hooks.addAction(`frontend/element_ready/${t}`,function(t){!function(t){t.find(".edit-template-with-light-box").on("click",function(e){e.preventDefault(),void 0!==a&&"function"==typeof a.showTemplatesModal&&a.showTemplatesModal(this)}),t.find(".elementor-custom-new-template-link").on("click",function(){window.location.href=e(this).attr("href")})}(t)})}),elementorFrontend.hooks.addAction("frontend/element_ready/crafto-template.default",function(t){var o=t.find(".edit-template-with-light-box").data("template-edit-link");t.find(".edit-template-with-light-box").on("click",function(){window.open(o,"_blank")}),t.find(".elementor-custom-new-template-link").on("click",function(){window.location.href=e(this).attr("href")})}),e(document).on("click","#custom-template-edit-modal .dialog-lightbox-close-button",function(e){e.preventDefault(),window.elementor.reloadPreview()})},showTemplatesModal:function(t){var o=e(t).data("template-edit-link");a.showModal(o)},showModal:function(t){var o,n;a.getModal().show();var i=e("#custom-template-edit-modal .dialog-message"),r="";r+='<iframe src="',r+=t,r+='" id="tabs-edit-frame" width="100%" height="100%"></iframe>';i.html(r),i.append('<div id="elementor-template-loading"><div class="elementor-loader-wrapper"><div class="elementor-loader"><div class="elementor-loader-boxes"><div class="elementor-loader-box"></div><div class="elementor-loader-box"></div><div class="elementor-loader-box"></div><div class="elementor-loader-box"></div></div></div><div class="elementor-loading-title">Loading</div></div></div>'),o=e("#tabs-edit-frame"),n=e("#elementor-template-loading"),o.on("load",function(){n.fadeOut(300)})},getModal:function(e){return a.modal||(this.modal=elementor.dialogsManager.createWidget("lightbox",{id:"custom-template-edit-modal",closeButton:!0,closeButtonClass:"eicon-close",hide:{onBackgroundClick:!1}})),a.modal},onFontChange:function(e,n){"custom"!==e&&"typekit"!==e||-1===t.indexOf(n)&&("typekit"===e&&o||a.craftoCustomFontsCallback(e,n))},craftoCustomFontsCallback:function(e,a){elementorCommon.ajax.addRequest("crafto_custom_fonts_action_data",{unique_id:"font_"+e+a,data:{service:"font",type:e,font:a},success:function(e){if(e.font_face){var t="";t+='<style type="text/css">',t+=e.font_face,t+="</style>",elementor.$previewContents.find("style:last").after(t)}if(e.font_url){var o="";o+='<link href="',o+=e.font_url,o+='" rel="stylesheet" type="text/css">',elementor.$previewContents.find("link:last").after(o)}}}),t.push(a),"typekit"===e&&(o=!0)},addMenuItems:function(){void 0!==elementorCommonConfig.finder&&[{name:"crafto-theme-settings-url",icon:"eicon-settings",title:elementor.config.i18n.crafto_panel_menu_item_customizer,type:"link",link:elementorCommonConfig.finder.data.site.items["wordpress-customizer"].url,newTab:!0}].forEach(function(e){elementor.modules.layouts.panel.pages.menu.Menu.addItem(e,"more","exit-to-dashboard")})}};e(window).on("elementor:init",a.init)}(jQuery);